/*!
 * jquery.qlip() - v1.0.0
 * http://adam.co/lab/jquery/qlip/
 * 01/05/2013
 *
 * Copyright 2013 Adam Coulombe
 * @license http://www.opensource.org/licenses/mit-license.html MIT License
 * @license http://www.gnu.org/licenses/gpl.html GPL2 License
 */
(function(a){a.extend({qlip:{call:function(c){var b=a("[data-qlip-id="+c.id+"]");b.trigger(c.event);if(c.event=="mousedown"){b.addClass("qlip-active")}if(c.event=="mouseup"){b.trigger("copy").removeClass("qlip-active")}if(c.event=="mouseover"){b.addClass("qlip-hover")}if(c.event=="mouseout"){b.removeClass("qlip-hover")}if(c.event=="loaded"){b.toggleClass("qlip-no-swf qlip-has-swf")}},environment:{touch:("ontouchstart" in document.documentElement),mac:(navigator.appVersion.indexOf("Mac")!=-1)}}});a.fn.extend({qlip:function(){var e=(typeof arguments[0]=="object")?arguments[0]:arguments[1],d=(typeof arguments[0]=="string")?arguments[0]:null,c=new Date().getTime(),g={swf:"qlip.swf",width:null,height:null,top:null,left:null,updateOnWindowResize:false};e=a.extend(g,e);var b=a('<div id="qlip-modal"/>'),f=a('<div id="qlip-modal-window"/>').appendTo(b),h=a('<div id="qlip-modal-label" />').appendTo(f);return this.each(function(k){var o=a(this),j=d||o.data("qlip-string"),l="qlip-"+c+"-"+k,n="string="+encodeURIComponent(j)+"&id="+l;o.addClass("qlip-no-swf");if(e.swf){if(o.css("position")=="static"){o.css("position","relative")}var m=a('<span class="qlip-swf" />').css({display:"block",position:"absolute"}).append(a('<object width="100%" height="100%" />').append(a('<param name="movie" value="'+e.swf+'" />'),a('<param name="flashvars" value="'+n+'" />'),a('<param name="wmode" value="transparent" />'),a('<embed src="'+e.swf+'" wmode="transparent" flashvars="'+n+'"  width="100%" height="100%" />')));o.on("update.qlip",function(){m.css({width:e.width||o.outerWidth(),height:e.height||o.outerHeight(),top:e.top||-parseInt(o.css("border-top-width")),left:e.left||-parseInt(o.css("border-top-width"))})}).append(m).trigger("update").attr("data-qlip-id",l);if(e.updateOnWindowResize){a(window).on("resize.qlip",function(){o.trigger("update.qlip")})}}o.on("click touchdown",function(){if(!a.qlip.environment.touch){var p=a.qlip.environment.mac?"&#8984;Cmd":"Ctrl";h.html("<kbd>"+p+"</kbd>+<kbd>C</kbd> to copy");var i=[17,91,224,93];a(window).on("keydown.qlip keyup.qlip",function(r){if(a.inArray(r.which,i)>-1){h.children("kbd:nth-of-type(1)").attr("class",r.type)}if(r.which==67){h.children("kbd:nth-of-type(2)").attr("class",r.type)}if(r.which==27){q.trigger("blur")}})}var q=a('<textarea id="qlip-modal-selection" />');f.empty().append(q,h);a("body").append(b);b.on("click.qlip touchdown.qlip",function(r){if(r.target!=q[0]){q.trigger("blur")}});q.html(j).on("focus.qlip",function(){a(this).select().get(0).setSelectionRange(0,9999)}).on("touchstart.qlip click.qlip",function(){a(this).trigger("focus.qlip")}).trigger("click.qlip").one("cut copy blur",function(r){a(window).off("keydown.qlip keyup.qlip");b.off("click.qlip touchstart.qlip");q.off("click.qlip touchstart.qlip focus.qlip");if(r.type=="cut"||r.type=="copy"){o.trigger("copy")}setTimeout(function(){b.addClass("close").one("animationend webkitAnimationEnd MSAnimationEnd oAnimationEnd",function(){b.removeClass("close").remove();h.children("kbd").attr("class","")})},100)})})})}})})(jQuery);